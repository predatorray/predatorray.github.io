---
layout: post
title: “告诉”而不要“询问”
---

原文地址：[Tell, Don't Ask][1]

Alec Sharp在最近出版的《Smalltalk by Example》中简要地指出了一个十分有价值的观点：

> 过程化代码获取信息，然后做出决策。而面向对象代码告诉对象做什么事。 — Alec Sharp

也就是说，你应当尝试告诉一个对象你想要它做什么，而不是询问它当前的状态，做出决策，然后让它再执行。

这里想要阐述的问题是，作为一个调用者，你不应该以被调用对象的状态来为其做出决策，修改那个对象的状态。这段所需实现的逻辑可能就是被调用对象的职责，而不是调用者的。你把这个做出决策的逻辑放在其外部就破坏了它的封装性。

当然你会说，这个十分明显，而且我从来没有写过这样的代码。但是，我们很容易不知不觉地写出检验一个对象并据此调用不同方法的代码。但是这绝不是一个好办法，而应该告诉对象你想要什么。接下来，让我们弄明白如何做到，以一种声明式的方式来思考这个问题，而不是过程式的。

如果我一开始就基于职责来设计类的话，我们很容易能摆脱这个陷阱。然后你就可以很自然地决定这个类应当执行哪些*命令*（command），而不是从对象中询问当前的状态。

## 仅仅是数据

我们这里主要的目的在于要把责任正确地划分到正确的功能上、类上，以防止过分地耦合其他的类。

向一个对象询问数据的最大危险在于你仅仅获得了数据。你本质上并没有获得了一个对象。就算查询的返回是一个具有结构化的对象（例如一个`String`对象），从语义上讲这也不是一个真正的对象。它已失去了其所属对象的关联。就例如返回`"RED"`，你无法知道这个意味着什么，可能是一个人的姓名、一辆车的颜色、测速器的状态。只有对象才知道这些上下文，而数据不知道。

面向对象编程的核心原则是方法与数据的联合统一。如果把它们两者不合适地分离，那你又回到了过程化的编程。

 [1]: http://pragprog.com/articles/tell-dont-ask